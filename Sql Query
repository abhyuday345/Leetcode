1757. Recyclable and Low Product

select product_id from products
where low_fats = 'Y' and recyclable = 'Y';

584. Find Customer Referee

select product_id from products
where low_fats = 'Y' and recyclable = 'Y';

595. Big Countries

SELECT name, population, area
FROM World
WHERE area >= 3000000
   OR population >= 25000000;

1148.Article Views I

select distinct(author_id) as 'id' from views
where author_id = viewer_id
order by author_id;

1683.Invalid Tweets

SELECT tweet_id
FROM Tweets
WHERE LENGTH(content) > 15;

1378. Replace Employee Id with new identifier

select unique_id,name from employees left join employeeuni on employees.id = employeeuni.id;

1068. Product Sales Analysis I

select product_name,year,price from sales s join 
product p on s.product_id = p.product_id;

1581. Customers who visited but did not make any transactions

select customer_id,count(*) as count_no_trans from visits v left join transactions t
on v.visit_id = t.visit_id
where transaction_id is null
group by customer_id;

197. Rising Temperature

SELECT id
FROM (
    SELECT 
        id,
        recordDate,
        temperature,
        LAG(temperature) OVER (ORDER BY recordDate) AS prev_temp,
        LAG(recordDate) OVER (ORDER BY recordDate) AS prev_date
    FROM Weather
) t
WHERE 
    temperature > prev_temp
    AND DATEDIFF(recordDate, prev_date) = 1;

1661. Average time of process per  minute

SELECT
    machine_id,
    round(avg(duration),3) AS processing_time
FROM (
    SELECT
        machine_id,
        process_id,
        MAX(CASE WHEN activity_type = 'end' THEN timestamp END) -
        MAX(CASE WHEN activity_type = 'start' THEN timestamp END) AS duration
    FROM activity
    GROUP BY machine_id, process_id
) t
GROUP BY machine_id;

577. Employee Bonus

select name,bonus from employee e left join bonus b on  
e.empid = b.empid
where bonus is null or bonus < 1000.
